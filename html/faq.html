

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>FAQ &mdash; Bento v0.0.5-gitd9c8ad8449 documentation</title>
    <link rel="stylesheet" href="static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.0.5-gitd9c8ad8449',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="static/jquery.js"></script>
    <script type="text/javascript" src="static/underscore.js"></script>
    <script type="text/javascript" src="static/doctools.js"></script>
    <link rel="top" title="Bento v0.0.5-gitd9c8ad8449 documentation" href="index.html" />
    <link rel="next" title="TODO" href="TODO.html" />
    <link rel="prev" title="Design notes" href="hacking.html" />
 
<style type="text/css">
  table.right { float: right; margin-left: 20px; }
  table.right td { border: 1px solid #ccc; }
</style>

  </head>
  <body>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="TODO.html" title="TODO"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="hacking.html" title="Design notes"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Bento home</a>&nbsp;|&nbsp;</li>
        <li><a href="contents.html">Documentation</a>
          &raquo;</li>
 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="contents.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">FAQ</a><ul>
<li><a class="reference internal" href="#why-to-create-a-new-tool">Why to create a new tool ?</a></li>
<li><a class="reference internal" href="#what-are-the-goals-of-bento">What are the goals of bento ?</a></li>
<li><a class="reference internal" href="#why-not-extending-existing-tools-distutils-etc">Why not extending existing tools (distutils, etc...) ?</a></li>
<li><a class="reference internal" href="#what-about-distutils2">What about distutils2 ?</a></li>
<li><a class="reference internal" href="#isn-t-it-too-difficult-to-support-building-extensions-on-every-platform">Isn&#8217;t it too difficult to support building extensions on every platform ?</a></li>
<li><a class="reference internal" href="#what-about-existing-projects-using-distutils">What about existing projects using distutils ?</a></li>
<li><a class="reference internal" href="#is-bento-based-on-existing-tools">Is bento based on existing tools ?</a></li>
<li><a class="reference internal" href="#who-are-the-authors-of-bento">Who are the authors of bento ?</a></li>
<li><a class="reference internal" href="#what-are-the-main-features-of-bento-compared-to-its-competitors">What are the main features of bento compared to its competitors</a></li>
<li><a class="reference internal" href="#does-bento-support-virtualenv">Does bento support virtualenv ?</a></li>
<li><a class="reference internal" href="#why-shouldn-t-i-use-bento">Why shouldn&#8217;t I use bento ?</a></li>
<li><a class="reference internal" href="#is-bento-api-stable">Is bento API stable ?</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="hacking.html"
                        title="previous chapter">Design notes</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="TODO.html"
                        title="next chapter">TODO</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/faq.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="faq">
<h1>FAQ<a class="headerlink" href="#faq" title="Permalink to this headline">¶</a></h1>
<div class="section" id="why-to-create-a-new-tool">
<h2>Why to create a new tool ?<a class="headerlink" href="#why-to-create-a-new-tool" title="Permalink to this headline">¶</a></h2>
<p>Because scientific code depends so much on compiled languages (C and Fortran),
the scipy community had to significantly extend distutils. It was found to be
more and more difficult to maintain, and the source of numerous user
complaints. In the last decade, several attemps of refactoring distutils and
our extensions have been made, but none succeeded.</p>
<p>Bento is born out of this experience. We also believe that current solutions
based on distutils suffer a lot of NIH, and ignore lessons learned in packaging
in most other systems.  Bento aims at shamelessly copying what works in other
systems (CPAN, CRAN, JSAN, HackageDB).</p>
<p>It should be noted that while bento currently first focus on improving the
situation for scipy community, it is in now way specific to it. Some features
like flexible installation scheme, simple data files handling are potentially
useful for anyone.</p>
</div>
<div class="section" id="what-are-the-goals-of-bento">
<h2>What are the goals of bento ?<a class="headerlink" href="#what-are-the-goals-of-bento" title="Permalink to this headline">¶</a></h2>
<p>The main goal of bento is to separate the concerns on building, packaging and
package description, so that it can be easily reused within custom build
frameworks (make, waf, scons, etc...). A simple build system is also provided
so that simple packages do not need to deal with anything besides bento.</p>
<p>Bento aims at being part of a grander vision for Scientific computing, to make
something like CPAN or CRAN available to python users.  By being simpler, more
explicit, it is hoped that bento will make the development of a
scientific-specific Pypi easier.</p>
</div>
<div class="section" id="why-not-extending-existing-tools-distutils-etc">
<h2>Why not extending existing tools (distutils, etc...) ?<a class="headerlink" href="#why-not-extending-existing-tools-distutils-etc" title="Permalink to this headline">¶</a></h2>
<p>There is a general consensus at least in the scientific python community that
distutils is deeply flawed:</p>
<blockquote>
<div><ul class="simple">
<li>The design by commands does not make much sense. In distutils, each
command has its own set of options, and getting the options from other
commands is difficult, if not impossible. For example, the install paths
are only known once the install command finalize_options has been run,
but knowing the install prefix at build time is often useful.</li>
<li>There is no developer documentation, and what consitutes public API is
not documented either. Consequently, every non trivial distutils
extension relies on internal details, and as such is fragile.</li>
<li>Extending by inheritence does not work well: when two modules A and B
extend distutils, it becomes difficult for B to reuse A (for example,
dealing with setuptools in numpy.distutils extensions has been a constant
source of bugs).</li>
<li>Customizing compilation flags, and more generally some tools involved in
compilation is too complicated. For example, adding a new tool in the
build chain requires rewriting the build command, which is aggravated by
the previous issue. We believe fixing this would end up in rewriting the
whole thing.</li>
<li>Improving distutils to handle dependencies automatically (rebuild only
the necessary .c files) is difficult because of the way distutils is
designed (build split across different commands, which may be
re-executed).</li>
<li>The codebase quality is horrible. Subclasses don&#8217;t share the same
interface, numerous attributes are conditionally added on the fly
depending on options, etc...</li>
</ul>
</div></blockquote>
<p>Overall, there is little to save in the current codebase. At least all of the
command and ccompiler code must go away, and that&#8217;s already 2/3 of distutils
code.  Given the relatively small size of distutils code, the only asset is its
&#8220;API&#8221;, but fixing what&#8217;s wrong with distutils precisely means breaking the API.
As such, a new tool written from scratch, but taking inspiration of existing
tools elsewhere is much more likely to be an actual improvement.</p>
<p>One should note that numpy&#8217;s extensions to distutils are pretty big:
numpy.distutils itself is as big as distutils in term of code size, and is the
biggest user of distutils API as far as I know.  Hence, we are well aware of
the cost of a total break from distutils.</p>
</div>
<div class="section" id="what-about-distutils2">
<h2>What about distutils2 ?<a class="headerlink" href="#what-about-distutils2" title="Permalink to this headline">¶</a></h2>
<p>We believe that most efforts in distutils2 are peripherical to our core issues
as described above, and won&#8217;t improve the situation for the scipy community.
History-wise, it should also be noted that Bento precedes distutils2 by a
couple of months (the first prototype was announced during my talk at scipy
India in december 2009).</p>
<p>Starting from the distutils codebase is not very appealing, as most of it would
need to be scrapped (at least the whole command and compiler business needs to
be completely rewritten). There are also irreconcilable differences on some
key points. In particular, we think the following features are essential:</p>
<blockquote>
<div><ol class="arabic simple">
<li>specified and versioned metadata formats, instead of implementation
specific data</li>
<li>enforced packaging policies (version, required metadata, etc...)</li>
<li>separate index of packages (so that you don&#8217;t need to download a lot
of software to know the dependencies of a package)</li>
<li>easy mirroring (ideally file based)</li>
<li>simple implementations</li>
</ol>
</div></blockquote>
<p>Although controversial in the python community, there is a large consensus
within the scipy community on those points.  Some of them have been rejected by
various distutils2 members (2, 3 and 4 in particular), and we are unwilling to
compromise on them. Distutils-related PEPs pushed by the distutils2 team will
be implemented on a case per case basis (some of them are obsolete as far as
bento is concerned, in the sense that they are already implemented, if only in
intent).</p>
<p>Moreover, as bento is designed from the ground up to be split into mostly
independent parts, it is possible to reuse its code in other projects. No
effort will be made to tie some features to bento to force people to use it.
If bento ends up being an experiment into useful new APIs integrated into
distutils2, bento would be considered successful. If our vision ends up being
wrong or unreachable, some of the code should be useful nonetheless.</p>
</div>
<div class="section" id="isn-t-it-too-difficult-to-support-building-extensions-on-every-platform">
<h2>Isn&#8217;t it too difficult to support building extensions on every platform ?<a class="headerlink" href="#isn-t-it-too-difficult-to-support-building-extensions-on-every-platform" title="Permalink to this headline">¶</a></h2>
<p>People often assume that distutils has a lot of platform-specific knowledge, in
particular to build C extensions. Except for a few exceptions (mostly on
non-Unix platforms), most of this knowledge actually comes from autoconf
through the sysconfig module.</p>
<p>Any non-superficial modification of the C compilation part of distutils will
also require reworking the platform-specific knowledge anyway.</p>
</div>
<div class="section" id="what-about-existing-projects-using-distutils">
<h2>What about existing projects using distutils ?<a class="headerlink" href="#what-about-existing-projects-using-distutils" title="Permalink to this headline">¶</a></h2>
<p>Bentomaker, the command line interface to bento, contains an experimental
command to convert existing setup.py to bento format.</p>
<p>I also believe it is possible to support most distutils/setuptools features in
bento file format, and convert a package description to a distutils/setuptools
Distribution instance. It could be used as a transition, so that packages who
have heavily invested in distutils can still use distutils extensions: the
metadata would be described in a bento.file, but distutils would still drive
the build and installation.</p>
</div>
<div class="section" id="is-bento-based-on-existing-tools">
<h2>Is bento based on existing tools ?<a class="headerlink" href="#is-bento-based-on-existing-tools" title="Permalink to this headline">¶</a></h2>
<p>The main inspirations for bento&#8217;s current design are taken from:</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference external" href="http://www.haskell.org/cabal">Cabal</a>, the packaging tool for Haskell: the bento file format is
mainly an adaptation of Cabal to python.</li>
<li><a class="reference external" href="http://sources.redhat.com/autobook/">Autoconf</a>, for the flexible install scheme, automake&#8217;s way of declaring
extra distribution files (data files).</li>
<li><a class="reference external" href="http://rpm5.org/docs/api/specfile.html">RPM</a>, for the spec file format.</li>
<li>Setuptools: exe-based script generation on windows, egg format</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="who-are-the-authors-of-bento">
<h2>Who are the authors of bento ?<a class="headerlink" href="#who-are-the-authors-of-bento" title="Permalink to this headline">¶</a></h2>
<p>Currently, I (David Cournapeau) am the main author of bento. I am a core
contributor to Numpy and Scipy, and have been the main maintainer of Numpy
distutils extensions for more than two years. I am also an occasional
contributor to scons (a make replacement in python), and debian packager.</p>
<dl class="docutils">
<dt>Other contributors:</dt>
<dd><ul class="first last simple">
<li>Stefan Van der Walt: initial implementation of the bento.info parser</li>
<li>Philip J. Eby: for answering most of my questions about
setuptools/eggs design</li>
</ul>
</dd>
<dt>A lot of inspiration came from waf, a great make replacement in python:</dt>
<dd><ul class="first last simple">
<li>Single file distribution</li>
<li>Yaku, bento&#8217;s internal build system is a dumbed-down waf clone</li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="what-are-the-main-features-of-bento-compared-to-its-competitors">
<h2>What are the main features of bento compared to its competitors<a class="headerlink" href="#what-are-the-main-features-of-bento-compared-to-its-competitors" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt>Bento has the following main features:</dt>
<dd><ul class="first last simple">
<li>Full static metadata description for simple packages</li>
<li>Arbitrary extensibility through python scripts</li>
<li>Reliable build and installation: no more stalled files when installing,
out-of-date source files and dependencies automatically detected for C
extensions</li>
<li>Optional recursive package description for complex packages</li>
<li>Easy customization of compilation flags and toolchain</li>
</ul>
</dd>
<dt>The following features are being implemented as well:</dt>
<dd><ul class="first last simple">
<li>Robust command dependencies from dependencies descriptor: no more
monkey-patching nonsense to insert a new command between two existing
subcommands</li>
<li>The build process may be replaced by make, waf or scons if desired, while
still keeping the installation and packaging features of bento (windows
installers, eggs, etc...)</li>
<li>New packaging format which can be translated to any existing one if
wanted (egg, wininst, msi, etc...). The format is optimized for
installation</li>
<li>Reliable uninstallation</li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="does-bento-support-virtualenv">
<h2>Does bento support virtualenv ?<a class="headerlink" href="#does-bento-support-virtualenv" title="Permalink to this headline">¶</a></h2>
<p>Depending on your definition of support, yes. If you run inside a virtualenv,
the following:</p>
<div class="highlight-python"><pre>bentomaker configure
bentomaker install</pre>
</div>
<p>will install the package inside the virtual environment (i.e. the same default
as when the setup.py uses setuptools). If you customized the prefix at
configure stage, it will of course not take into account the virtual
environment:</p>
<div class="highlight-python"><pre>bentomaker configure --prefix=/usr/local
bentomaker install</pre>
</div>
</div>
<div class="section" id="why-shouldn-t-i-use-bento">
<h2>Why shouldn&#8217;t I use bento ?<a class="headerlink" href="#why-shouldn-t-i-use-bento" title="Permalink to this headline">¶</a></h2>
<p>While I believe bento to be significantly better than other existing solutions,
bento has some significant disadvantages as well that you need to be aware of:</p>
<blockquote>
<div><ul class="simple">
<li>Still mostly a one-man show. However, once bento reaches a satisfying
level, it will likely be used as a replacement to distutils for numpy and
scipy, and hopefully beyond</li>
<li>Relatively weak testing: bento has a test suite with average coverage
(~50-60 %). Some parts like the bento.info parser reach near full
coverage, other parts such as bentomaker are lower than 50 %.
Bento is mainly developed on mac os x and linux on python 2.6, so those
should rarely break. Bento test suite also run on a continuous
integration system for every python version from 2.4 to 3.1 on a linux
vm, and I sometimes check that things work on windows as well.</li>
<li>Weak documentation: hopefully, this is getting better.</li>
<li>Mediocre code quality: I focused on the general architecture and
low-coupling which are the main issues I had with distutils, but at a
lower level, a lot of code leaves to be desired (style inconsistencies,
etc...). As for testing, some parts are pretty good, other are damn awful.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="is-bento-api-stable">
<h2>Is bento API stable ?<a class="headerlink" href="#is-bento-api-stable" title="Permalink to this headline">¶</a></h2>
<p>As the current version suggest, no. As long as you only use the bento.info file
(no hook), you should be pretty safe - I don&#8217;t expect the bento.info file to
change in any significant backward-incompatible way.</p>
<p>However, the API to be used inside hook files leaves a lot to be desired, and
will change in backward incompatible ways before the first alpha. The good side
is that you can complain about the API and get it fixed until then.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="TODO.html" title="TODO"
             >next</a> |</li>
        <li class="right" >
          <a href="hacking.html" title="Design notes"
             >previous</a> |</li>
        <li><a href="index.html">Bento home</a>&nbsp;|&nbsp;</li>
        <li><a href="contents.html">Documentation</a>
          &raquo;</li>
 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2009-2011, David Cournapeau.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.7.
    </div>
  </body>
</html>