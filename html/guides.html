
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Guides &mdash; Bento 0.0.7-gita5f7bdbd9d documentation</title>
    
    <link rel="stylesheet" href="static/nature.css" type="text/css" />
    <link rel="stylesheet" href="static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.0.7-gita5f7bdbd9d',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="static/jquery.js"></script>
    <script type="text/javascript" src="static/underscore.js"></script>
    <script type="text/javascript" src="static/doctools.js"></script>
    <link rel="top" title="Bento 0.0.7-gita5f7bdbd9d documentation" href="index.html" />
    <link rel="next" title="Reference" href="reference/index.html" />
    <link rel="prev" title="Tutorial" href="tutorial.html" />
 
<style type="text/css">
  table.right { float: right; margin-left: 20px; }
  table.right td { border: 1px solid #ccc; }
</style>

  </head>
  <body>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="reference/index.html" title="Reference"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="tutorial.html" title="Tutorial"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Bento home</a>&nbsp;|&nbsp;</li>
        <li><a href="contents.html">Documentation</a>
          &raquo;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="guides">
<h1>Guides<a class="headerlink" href="#guides" title="Permalink to this headline">¶</a></h1>
<div class="section" id="specifiying-data-files">
<h2>Specifiying data files<a class="headerlink" href="#specifiying-data-files" title="Permalink to this headline">¶</a></h2>
<p>Most packages have some files besides pure code: configuration, data
files, documentation, etc... When those files need to be installed,
you should use DataFiles sections. Each such section has two mandatory
fields, to specify the target directory (where files are installed)
and which files are specific to this section:</p>
<div class="highlight-python"><pre>DataFiles: manage
    TargetDir: /usr/man/man1
    Files: fubar/fubar1</pre>
</div>
<p>This will install the file top_dir/fubar/fubar1 into
/usr/man/man1/fubar/fubar1.</p>
<div class="section" id="flexible-install-scheme">
<h3>Flexible install scheme<a class="headerlink" href="#flexible-install-scheme" title="Permalink to this headline">¶</a></h3>
<p>Hardcoding the target directory as above is not flexibe. The user may
want to install manpages somewhere else. Bento defines a set of
variable paths which are customizable from bentomaker, with platform-specific
defaults. For manpages, the variable is mandir:</p>
<div class="highlight-python"><pre>DataFiles: manpage
    TargetDir: $mandir/man1
    Files: fubar/fubar.1</pre>
</div>
<p>Now, the installation path is customizable, e.g.:</p>
<div class="highlight-python"><pre>bentomaker configure --mandir=/opt/man</pre>
</div>
<p>will cause the target directory to translate to /opt/man/man1.
Moreover, as mandir default value is defined relatively to $prefix ($prefix/man
on unix), modifying the prefix will also change how mandir is expanded at
install time:</p>
<div class="highlight-python"><pre># $mandir is automatically expanded to /opt/man
bentomaker configure --prefix=/opt</pre>
</div>
<p>If you do not want to install files with their directory component,
you need to use the SourceDir option:</p>
<div class="highlight-python"><pre>DataFiles: manpage
    TargetDir: $mandir
    SourceDir: fubar
    Files: fubar.1</pre>
</div>
<p>will install fubar/fubar.1 as $mandir/fubar.1 instead of
$mandir/fubar/fubar.1.</p>
</div>
<div class="section" id="custom-data-paths">
<h3>Custom data paths<a class="headerlink" href="#custom-data-paths" title="Permalink to this headline">¶</a></h3>
<p>While the default list should cover most package needs, it is sometimes useful
to define custom path variable:</p>
<div class="highlight-python"><pre>Path: foo
    Description: foo directory
    Default: $datadir/foo</pre>
</div>
<p>Bentomaker will automatically add the &#8211;foodir option, and $foo will be
expanded to the customized value (or $datadir/foo by default). The description
will be used as a description in the help message.</p>
</div>
</div>
<div class="section" id="retrieving-data-files-at-runtime">
<h2>Retrieving data files at runtime<a class="headerlink" href="#retrieving-data-files-at-runtime" title="Permalink to this headline">¶</a></h2>
<p>It is often necessary to retrieve data files from your python code.  For
example, you may have a configuration file which needs to be read at startup.
The simplest way to do so is to use __file__ and refer to data files relatively
to python code location. This is not very flexible, because it requires dealing
with platform idiosyncraties w.r.t. file location.  Setuptools and its
descendents have an alternative mechanism to retrieve resources at runtime,
implemented in the pkg_resource module.</p>
<p>Bento uses a much simpler system, based on a simple python module generated at
install time, containing all the relevant information. This file is not
generated by default, and you need to define which file will contain all those
variables with the ConfigPy field:</p>
<div class="highlight-python"><pre>ConfigPy: foo/__bento_config.py</pre>
</div>
<p>This tells bento to generate a module, and install it into
foo/__bento_config.py. The path is always relative to site-packages (e.g.
/usr/local/lib/python2.6/site-packages/foo/__bento_config.py by default on
unix).  The file looks as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">DOCDIR</span> <span class="o">=</span> <span class="s">&quot;/usr/local/share/doc/config_py&quot;</span>
<span class="n">SHAREDSTATEDIR</span> <span class="o">=</span> <span class="s">&quot;/usr/local/com&quot;</span>
<span class="o">...</span>
</pre></div>
</div>
<p>to that you can import every path variable with its expanded value in your
package:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">foo.__bento_config</span> <span class="kn">import</span> <span class="n">DOCDIR</span><span class="p">,</span> <span class="n">SHAREDSTATEDIR</span>
</pre></div>
</div>
<p>As the generated python module is a simple python file with pair values, it is
easy to modify it if desired (for debugging, etc...), and understandable by any
python programmer.</p>
<p>If you need to support the case where the package has not been built yet, you
can do as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">foo.__bento_config</span> <span class="kn">import</span> <span class="n">DOCDIR</span><span class="p">,</span> <span class="n">SHAREDSTATEDIR</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="c"># Default values (so that the package may be imported/used without</span>
    <span class="c"># being built)</span>
    <span class="n">DOCDIR</span> <span class="o">=</span> <span class="o">...</span>
</pre></div>
</div>
<p>This is not done by default as it is not possible to know the right default
value.</p>
<div class="section" id="example">
<h3>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h3>
<p>Assuming the following bento file:</p>
<div class="highlight-python"><pre>...

DataFiles: test_data
    SourceDir: data
    TargetDir: $pkgdatadir
    Files:
        foo.dat

ConfigPy: foo/__bento_config.py</pre>
</div>
<p>you can access &#8220;foo.dat&#8221; as follows in your package:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">foo.__bento_config</span> <span class="kn">import</span> <span class="n">PKGDATADIR</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="n">PKGDATADIR</span> <span class="o">=</span> <span class="s">&quot;data&quot;</span> <span class="c"># default value</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PKGDATADIR</span><span class="p">,</span> <span class="s">&quot;foo.dat&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This will point to the right location independently on $pkgdatadir value.</p>
</div>
</div>
<div class="section" id="recursive-package-description">
<h2>Recursive package description<a class="headerlink" href="#recursive-package-description" title="Permalink to this headline">¶</a></h2>
<p>If you have a package with a lot of python subpackages which require
custom configurations, doing everything in one bento.info file is
restrictive. Bento has a simple recursive feature so that one
bento.info can refer to another bento.info:</p>
<div class="highlight-python"><pre>...
Recurse: foo, bar</pre>
</div>
<p>The Recurse field indicates to bento that it should look for bento.info in both
foo/ and bar/ directories. At this time, those bento.info files support a
strict subset of the top bento.info. For example, no metadata may be defined in
sub-bento.info.</p>
<div class="section" id="simple-example">
<h3>Simple example<a class="headerlink" href="#simple-example" title="Permalink to this headline">¶</a></h3>
<p>Let&#8217;s assume that you have a software with the packages foo, foo.bar
and foo.foo. The simplest way to define this software would be:</p>
<div class="highlight-python"><pre>...
Library:
    Packages: foo, foo.bar, foo.fubar</pre>
</div>
<p>Alternatively, an equivalent description, using the recursive feature:</p>
<div class="highlight-python"><pre>...
Recurse: foo

Library:
    Package: foo</pre>
</div>
<p>and the foo/bento.info:</p>
<div class="highlight-python"><pre>...
Library:
    Packages: bar, fubar</pre>
</div>
<p>The packages are defined relatively to the directory where the subento file is
located. Obviously, in this case, it is overkill, but for complex, deeply
nested packages (like scipy or twisted), this makes the bento.info more
readable. It is especially useful when you use this with the hook file
mechanism, where each subento file can drive a part of the configure/build
through command hooks and overrides. In that case, the hook file defined in a
subdirectory only sees the libraries, modules, etc... defined in the
corresponding bento.info by default (see hook section).</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="contents.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Guides</a><ul>
<li><a class="reference internal" href="#specifiying-data-files">Specifiying data files</a><ul>
<li><a class="reference internal" href="#flexible-install-scheme">Flexible install scheme</a></li>
<li><a class="reference internal" href="#custom-data-paths">Custom data paths</a></li>
</ul>
</li>
<li><a class="reference internal" href="#retrieving-data-files-at-runtime">Retrieving data files at runtime</a><ul>
<li><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#recursive-package-description">Recursive package description</a><ul>
<li><a class="reference internal" href="#simple-example">Simple example</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="tutorial.html"
                        title="previous chapter">Tutorial</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="reference/index.html"
                        title="next chapter">Reference</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/guides.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="reference/index.html" title="Reference"
             >next</a> |</li>
        <li class="right" >
          <a href="tutorial.html" title="Tutorial"
             >previous</a> |</li>
        <li><a href="index.html">Bento home</a>&nbsp;|&nbsp;</li>
        <li><a href="contents.html">Documentation</a>
          &raquo;</li>
 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2009-2011, David Cournapeau.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.
    </div>
  </body>
</html>